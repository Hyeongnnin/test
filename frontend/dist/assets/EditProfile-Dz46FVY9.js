import{d as E,r as n,D as R,i as h,o as S,c as l,b as r,g as P,z,t as b,p as w,A as d,B as i,n as A,u as T,h as u}from"./index-DamHdx69.js";import{a as k}from"./api-DXNNeTpL.js";import{u as q,_ as J}from"./userStore-CiV_CRMt.js";const L={class:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8"},O={class:"max-w-2xl mx-auto"},H={class:"bg-white rounded-lg border border-gray-200 shadow-sm p-8"},K={class:"border-b border-gray-200 pb-8"},Q={class:"flex flex-col items-center gap-6"},W={class:"w-24 h-24 rounded-full overflow-hidden shadow-md bg-gray-100"},X=["src"],Y={key:1,class:"w-full h-full flex items-center justify-center text-white font-bold text-3xl bg-gradient-to-br from-brand-400 to-brand-600"},Z={class:"flex gap-3"},$={class:"border-b border-gray-200 pb-8"},ee={class:"space-y-5"},re={class:"border-b border-gray-200 pb-8"},te={class:"space-y-5"},oe={key:0,class:"mt-2 text-sm text-red-600"},se={class:"flex items-center gap-3 justify-between pt-4"},ae=["disabled"],ne={key:0,class:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg text-sm text-green-700"},le={key:1,class:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700"},de=E({__name:"EditProfile",setup(ie){const{fetchMe:_}=q(),U=T(),p=n(null),m=n(!1),f=n(""),a=n(""),C=n({}),t=R({name:"",email:"",phone:"",currentPassword:"",newPassword:"",confirmPassword:""}),V=h(()=>t.name?t.name.charAt(0):"사용자".charAt(0)),y=h(()=>t.newPassword&&t.confirmPassword&&t.newPassword!==t.confirmPassword),B=h(()=>!(!t.name||!t.email||(t.newPassword||t.confirmPassword)&&(!t.currentPassword||!t.newPassword||!t.confirmPassword||y.value))),c=n(null),g=n(null),x=n(!1);S(async()=>{try{const e=(await k.get("/accounts/profile/me/")).data;t.name=e.first_name||e.username||"",t.email=e.email||"",t.phone=e.phone_number||"",c.value=e.avatar||null,await _()}catch(s){console.error("profile fetch error",s)}});function j(){var s;(s=p.value)==null||s.click()}function F(s){var v;const o=(v=s.target.files)==null?void 0:v[0];if(x.value=!1,o){if(o.size>5*1024*1024){a.value="파일 크기는 5MB 이하여야 합니다.";return}if(!["image/jpeg","image/png","image/gif"].includes(o.type)){a.value="JPG, PNG, GIF 형식의 파일만 가능합니다.";return}g.value=o;const N=URL.createObjectURL(o);c.value=N}}function G(){c.value=null,g.value=null,x.value=!0,p.value&&(p.value.value="")}function I(){}async function D(){var s;if(C.value={},!t.name||!t.email){a.value="이름과 이메일은 필수입니다.";return}m.value=!0,a.value="",f.value="";try{const e=new FormData;e.append("first_name",t.name),e.append("email",t.email),e.append("phone_number",t.phone),g.value&&e.append("avatar",g.value),x.value&&e.append("avatar_clear","1");const o=await k.patch("/accounts/profile/me/",e,{headers:{"Content-Type":"multipart/form-data"}});if(t.currentPassword||t.newPassword||t.confirmPassword){const v=await k.post("/accounts/profile/change-password/",{current_password:t.currentPassword,new_password:t.newPassword,new_password_confirm:t.confirmPassword});t.currentPassword="",t.newPassword="",t.confirmPassword=""}f.value="프로필이 저장되었습니다.",await _()}catch(e){if(console.error("save error",e),(s=e.response)!=null&&s.data){const o=e.response.data;C.value=o,a.value=o.detail||"저장에 실패했습니다."}else a.value="저장 중 오류가 발생했습니다."}finally{m.value=!1}}function M(){U.back()}return(s,e)=>(u(),l("div",L,[r("div",O,[r("div",{class:"flex items-center gap-3 mb-8"},[r("button",{onClick:M,class:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors duration-200"},[...e[6]||(e[6]=[r("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),e[7]||(e[7]=r("h1",{class:"text-3xl font-bold text-gray-900"},"프로필 수정",-1))]),r("div",H,[r("form",{onSubmit:z(D,["prevent"]),class:"space-y-8"},[r("div",K,[e[9]||(e[9]=r("h2",{class:"text-lg font-semibold text-gray-900 mb-6"},"프로필 이미지",-1)),r("div",Q,[r("div",W,[c.value?(u(),l("img",{key:0,src:c.value,alt:"Profile",class:"w-full h-full object-cover"},null,8,X)):(u(),l("div",Y,b(V.value),1))]),r("div",Z,[r("input",{type:"file",ref_key:"fileInput",ref:p,accept:"image/*",class:"hidden",onChange:F},null,544),r("button",{type:"button",onClick:j,class:"px-4 py-2 text-sm font-medium text-brand-600 border border-brand-300 rounded-lg hover:bg-brand-50 transition-colors duration-200"}," 이미지 업로드 "),r("button",{type:"button",onClick:G,class:"px-4 py-2 text-sm font-medium text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200"}," 제거 ")]),e[8]||(e[8]=r("p",{class:"text-xs text-gray-500 text-center"},[w(" JPG, PNG, GIF 형식의 파일만 가능합니다."),r("br"),w(" 최대 파일 크기: 5MB ")],-1))])]),r("div",$,[e[13]||(e[13]=r("h2",{class:"text-lg font-semibold text-gray-900 mb-6"},"기본 정보",-1)),r("div",ee,[r("div",null,[e[10]||(e[10]=r("label",{for:"name",class:"block text-sm font-medium text-gray-900 mb-2"},[w(" 이름 "),r("span",{class:"text-red-500"},"*")],-1)),d(r("input",{id:"name","onUpdate:modelValue":e[0]||(e[0]=o=>t.name=o),type:"text",class:"w-full px-4 py-2.5 rounded-lg border border-gray-300 bg-white text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all duration-200",placeholder:"홀길동",required:""},null,512),[[i,t.name]])]),r("div",null,[e[11]||(e[11]=r("label",{for:"email",class:"block text-sm font-medium text-gray-900 mb-2"},[w(" 이메일 "),r("span",{class:"text-red-500"},"*")],-1)),d(r("input",{id:"email","onUpdate:modelValue":e[1]||(e[1]=o=>t.email=o),type:"email",class:"w-full px-4 py-2.5 rounded-lg border border-gray-300 bg-white text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all duration-200",placeholder:"example@example.com",required:""},null,512),[[i,t.email]])]),r("div",null,[e[12]||(e[12]=r("label",{for:"phone",class:"block text-sm font-medium text-gray-900 mb-2"}," 전화번호 ",-1)),d(r("input",{id:"phone","onUpdate:modelValue":e[2]||(e[2]=o=>t.phone=o),type:"tel",class:"w-full px-4 py-2.5 rounded-lg border border-gray-300 bg-white text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all duration-200",placeholder:"010-1234-5678"},null,512),[[i,t.phone]])])])]),r("div",re,[e[18]||(e[18]=r("h2",{class:"text-lg font-semibold text-gray-900 mb-2"},"비밀번호 변경",-1)),e[19]||(e[19]=r("p",{class:"text-sm text-gray-500 mb-6"},"비밀번호를 변경하려면 아래 필드를 입력하세요.",-1)),r("div",te,[r("div",null,[e[14]||(e[14]=r("label",{for:"currentPassword",class:"block text-sm font-medium text-gray-900 mb-2"}," 현재 비밀번호 ",-1)),d(r("input",{id:"currentPassword","onUpdate:modelValue":e[3]||(e[3]=o=>t.currentPassword=o),type:"password",class:"w-full px-4 py-2.5 rounded-lg border border-gray-300 bg-white text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all duration-200",placeholder:"현재 비밀번호를 입력하세요"},null,512),[[i,t.currentPassword]])]),r("div",null,[e[15]||(e[15]=r("label",{for:"newPassword",class:"block text-sm font-medium text-gray-900 mb-2"}," 새 비밀번호 ",-1)),d(r("input",{id:"newPassword","onUpdate:modelValue":e[4]||(e[4]=o=>t.newPassword=o),type:"password",class:"w-full px-4 py-2.5 rounded-lg border border-gray-300 bg-white text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all duration-200",placeholder:"새 비밀번호를 입력하세요",onInput:I},null,544),[[i,t.newPassword]])]),r("div",null,[e[16]||(e[16]=r("label",{for:"confirmPassword",class:"block text-sm font-medium text-gray-900 mb-2"}," 비밀번호 확인 ",-1)),d(r("input",{id:"confirmPassword","onUpdate:modelValue":e[5]||(e[5]=o=>t.confirmPassword=o),type:"password",class:A(["w-full px-4 py-2.5 rounded-lg border border-gray-300 bg-white text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all duration-200",{"border-red-500 focus:ring-red-500":y.value&&t.confirmPassword}]),placeholder:"비밀번호를 다시 입력하세요",onInput:I},null,34),[[i,t.confirmPassword]]),y.value&&t.confirmPassword?(u(),l("p",oe," 비밀번호가 일치하지 않습니다. ")):P("",!0)]),e[17]||(e[17]=r("div",{class:"bg-gray-50 border border-gray-200 rounded-lg p-4 text-sm text-gray-600"},[r("p",{class:"font-medium text-gray-900 mb-2"},"비밀번호는 다음을 만족해야 합니다:"),r("ul",{class:"space-y-1 list-disc list-inside"},[r("li",null,"8자 이상 20자 이하"),r("li",null,"영문, 숫자, 특수문자를 포함")])],-1))])]),r("div",se,[r("button",{type:"button",onClick:M,class:"px-6 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200"}," 취소 "),r("button",{type:"submit",disabled:m.value||!B.value,class:"px-6 py-2.5 text-sm font-medium text-white bg-brand-600 rounded-lg hover:bg-brand-700 active:bg-brand-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"},b(m.value?"저장 중...":"저장하기"),9,ae)])],32)]),f.value?(u(),l("div",ne,b(f.value),1)):P("",!0),a.value?(u(),l("div",le,b(a.value),1)):P("",!0)])]))}}),me=J(de,[["__scopeId","data-v-ce279a28"]]);export{me as default};
