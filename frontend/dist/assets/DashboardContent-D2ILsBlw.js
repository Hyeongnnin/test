import{a as j}from"./api-DXNNeTpL.js";import{d as J,r as g,q as N,i as k,c as p,g as D,h as m,b as e,t as o,A as V,B as A,o as E,l as Y,F as B,k as H,n as U,a as W,x as z,v as K,m as I,e as q}from"./index-DamHdx69.js";import{u as P,a as R}from"./MainLayout-B5bxgMFS.js";import"./userStore-CiV_CRMt.js";const Q={key:0,class:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50"},G={class:"bg-white rounded-lg w-full max-w-md p-6"},X={class:"flex justify-between items-center mb-4"},Z={class:"text-lg font-semibold"},O={class:"space-y-4"},ee={key:0,class:"text-sm text-red-600"},te={class:"mt-6 flex items-center justify-end gap-2"},se=J({__name:"WorkDayModal",props:{visible:{type:Boolean,required:!0},employeeId:{type:Number,required:!0},dateIso:{type:String,required:!0},record:{type:Object,required:!1,default:null}},emits:["close","saved","deleted"],setup(w,{emit:u}){const s=w,d=u,t=g(null),a=g(null),f=g(0),r=g(null);N(()=>s.record,v=>{v?(t.value=v.time_in?v.time_in.split("T")[1].slice(0,5):null,a.value=v.time_out?v.time_out.split("T")[1].slice(0,5):null,f.value=v.break_minutes||0):(t.value=null,a.value=null,f.value=0)},{immediate:!0});const l=k(()=>{try{return new Date(s.dateIso).toLocaleDateString()}catch{return s.dateIso}});function x(){d("close")}function c(){return t.value&&!/^\d{2}:\d{2}$/.test(t.value)?"출근 시간이 형식에 맞지 않습니다.":a.value&&!/^\d{2}:\d{2}$/.test(a.value)?"퇴근 시간이 형식에 맞지 않습니다.":null}async function _(){var F,L;r.value=null;const v=c();if(v){r.value=v;return}const n=s.dateIso,b={employee:s.employeeId,work_date:n,break_minutes:f.value||0};t.value?b.time_in=`${n}T${t.value}:00`:b.time_in=null,a.value?b.time_out=`${n}T${a.value}:00`:b.time_out=null;try{s.record&&s.record.id?(await j.patch(`/labor/work-records/${s.record.id}/`,b),d("saved"),x()):(await j.post("/labor/work-records/",b),d("saved"),x())}catch(M){console.error("save failed",M),r.value=((L=(F=M==null?void 0:M.response)==null?void 0:F.data)==null?void 0:L.detail)||"저장 중 오류가 발생했습니다."}}async function $(){var v,n;if(s.record&&s.record.id)try{await j.delete(`/labor/work-records/${s.record.id}/`),d("deleted"),x()}catch(b){console.error("delete failed",b),r.value=((n=(v=b==null?void 0:b.response)==null?void 0:v.data)==null?void 0:n.detail)||"삭제 중 오류가 발생했습니다."}}return(v,n)=>w.visible?(m(),p("div",Q,[e("div",G,[e("div",X,[e("h3",Z,o(l.value)+" 근로기록",1),e("button",{onClick:x,class:"text-gray-500"},"✕")]),e("div",O,[e("div",null,[n[3]||(n[3]=e("label",{class:"block text-sm text-gray-700 mb-1"},"출근 시간",-1)),V(e("input",{type:"time","onUpdate:modelValue":n[0]||(n[0]=b=>t.value=b),class:"w-full px-3 py-2 border rounded"},null,512),[[A,t.value]])]),e("div",null,[n[4]||(n[4]=e("label",{class:"block text-sm text-gray-700 mb-1"},"퇴근 시간",-1)),V(e("input",{type:"time","onUpdate:modelValue":n[1]||(n[1]=b=>a.value=b),class:"w-full px-3 py-2 border rounded"},null,512),[[A,a.value]])]),e("div",null,[n[5]||(n[5]=e("label",{class:"block text-sm text-gray-700 mb-1"},"휴게(분)",-1)),V(e("input",{type:"number","onUpdate:modelValue":n[2]||(n[2]=b=>f.value=b),min:"0",class:"w-full px-3 py-2 border rounded"},null,512),[[A,f.value,void 0,{number:!0}]])]),r.value?(m(),p("div",ee,o(r.value),1)):D("",!0)]),e("div",te,[w.record&&w.record.id?(m(),p("button",{key:0,onClick:$,class:"px-4 py-2 bg-red-500 text-white rounded"},"삭제")):D("",!0),e("button",{onClick:x,class:"px-4 py-2 bg-gray-100 rounded"},"취소"),e("button",{onClick:_,class:"px-4 py-2 bg-brand-600 text-white rounded"},"저장")])])])):D("",!0)}}),le={class:"bg-white rounded-lg border border-gray-200 p-6"},ae={class:"flex items-center justify-between mb-6"},oe={class:"text-lg font-semibold text-gray-900"},re={class:"grid grid-cols-7 gap-2 mb-4"},ne={class:"grid grid-cols-7 gap-2"},de=["onClick"],ie={key:0,class:"mt-6 pt-6 border-t border-gray-200"},ue={class:"text-sm font-medium text-gray-900 mb-3"},ce=J({__name:"WorkCalendar",props:{activeJob:{default:null}},setup(w){const u=w,s=g(new Date),d=g(null),t=g(!1),a=g(null),f=g(""),r=k(()=>s.value.getFullYear()),l=k(()=>s.value.getMonth()+1),x=k(()=>{const y=s.value.getFullYear(),i=s.value.getMonth(),S=new Date(y,i,1).getDay(),h=new Date(y,i+1,0).getDate(),T=[];for(let C=0;C<S;C++)T.push({day:0});for(let C=1;C<=h;C++)T.push({day:C});return T}),c=k(()=>`${r.value}-${String(l.value).padStart(2,"0")}`),_=g(null),$=k(()=>{const y={};if(!_.value)return y;for(const i of _.value.dates)y[i.day]={date:i.date,record:i.record};return y});async function v(){if(u.activeJob)try{const y=await j.get(`/labor/jobs/${u.activeJob.id}/calendar/`,{params:{month:c.value}});_.value=y.data}catch(y){console.error("Failed to load calendar",y)}}E(()=>{v()}),N(c,()=>v());const n=()=>{s.value=new Date(s.value.getFullYear(),s.value.getMonth()-1),d.value=null},b=()=>{s.value=new Date(s.value.getFullYear(),s.value.getMonth()+1),d.value=null};function F(y){if(y===0||!u.activeJob||(d.value=y,!_.value))return;const i=_.value.dates.find(S=>S.day===y);f.value=(i==null?void 0:i.date)||`${r.value}-${String(l.value).padStart(2,"0")}-${String(y).padStart(2,"0")}`,a.value=(i==null?void 0:i.record)||null,t.value=!0}function L(){t.value=!1,a.value=null,v()}function M(){t.value=!1,a.value=null,v()}return(y,i)=>{var S;return m(),p("div",le,[e("div",ae,[e("div",null,[e("h3",oe,o(r.value)+"년 "+o(l.value)+"월",1),i[1]||(i[1]=e("p",{class:"text-sm text-gray-500 mt-1"},"근로시간 기록",-1))]),e("div",{class:"flex gap-2"},[e("button",{onClick:n,class:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"}," ◀ "),e("button",{onClick:b,class:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"}," ▶ ")])]),e("div",re,[(m(),p(B,null,H(["일","월","화","수","목","금","토"],h=>e("div",{key:h,class:"text-center text-xs font-semibold text-gray-600 py-2"},o(h),1)),64))]),e("div",ne,[(m(!0),p(B,null,H(x.value,h=>(m(),p("button",{key:h.day+"-"+Math.random(),onClick:T=>F(h.day),class:U(["aspect-square flex items-center justify-center text-sm rounded-lg font-medium transition-all",h.day===0?"text-gray-300 cursor-default":h.day===d.value?"bg-brand-600 text-white shadow-md":$.value.value[h.day]?"text-white bg-red-500":"text-gray-700 hover:bg-brand-50 cursor-pointer"])},o(h.day===0?"":h.day),11,de))),128))]),d.value?(m(),p("div",ie,[e("p",ue,o(r.value)+"년 "+o(l.value)+"월 "+o(d.value)+"일 근로시간 ",1),i[2]||(i[2]=e("div",{class:"bg-brand-50 rounded-lg p-4 border border-brand-100"},[e("p",{class:"text-2xl font-bold text-brand-600"},"8시간"),e("p",{class:"text-xs text-gray-600 mt-1"},"09:00 AM - 06:00 PM (휴게 1시간)")],-1))])):D("",!0),t.value?(m(),Y(se,{key:1,visible:t.value,employeeId:(S=u.activeJob)==null?void 0:S.id,dateIso:f.value,record:a.value,onClose:i[0]||(i[0]=h=>t.value=!1),onSaved:L,onDeleted:M},null,8,["visible","employeeId","dateIso","record"])):D("",!0)])}}}),be={class:"mt-6"},ve={class:"bg-white rounded-lg border border-gray-200 shadow-sm p-6"},ge={key:0,class:"text-sm text-gray-500 py-4"},me={key:1,class:"p-3 bg-red-50 border border-red-200 rounded text-sm text-red-700"},xe={key:2,class:"grid sm:grid-cols-3 gap-4 items-end"},pe={class:"sm:col-span-3"},ye={class:"text-3xl sm:text-4xl font-extrabold",style:{color:"#DE5D35"}},fe={class:"p-4 rounded-lg bg-gray-50 border border-gray-200"},_e={class:"text-xl font-bold text-gray-900 mt-1"},he={class:"p-4 rounded-lg bg-gray-50 border border-gray-200"},we={class:"text-xl font-bold text-gray-900 mt-1"},$e={class:"p-4 rounded-lg bg-gray-50 border border-gray-200"},ke={class:"text-xl font-bold text-gray-900 mt-1"},De=J({__name:"LaborAnnualLeaveCard",setup(w){const{activeJob:u}=P(),{fetchAnnualLeave:s}=R(),d=g(!1),t=g(null),a=g(null);async function f(){var r,l;if(u.value){d.value=!0,t.value=null;try{a.value=await s(u.value.id)}catch(x){t.value=((l=(r=x==null?void 0:x.response)==null?void 0:r.data)==null?void 0:l.detail)||"연차 정보를 불러올 수 없습니다.",a.value=null}finally{d.value=!1}}}return N(()=>{var r;return(r=u.value)==null?void 0:r.id},()=>f()),E(()=>{f(),window.addEventListener("job-updated",f)}),(r,l)=>(m(),p("div",be,[e("div",ve,[l[4]||(l[4]=e("div",{class:"flex items-center justify-between mb-4"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"연차휴가"),e("span",{class:"inline-flex items-center px-2 py-0.5 text-xs font-medium rounded-full",style:{backgroundColor:"#FFE7DF",color:"#DE5D35"}},"Notav")],-1)),d.value?(m(),p("div",ge,"연차 정보를 불러오는 중…")):t.value?(m(),p("div",me,o(t.value),1)):a.value?(m(),p("div",xe,[e("div",pe,[l[0]||(l[0]=e("p",{class:"text-sm text-gray-600 mb-1"},"사용 가능 연차",-1)),e("p",ye,o(a.value.available)+"일",1)]),e("div",fe,[l[1]||(l[1]=e("p",{class:"text-xs text-gray-500"},"올해 발생 연차",-1)),e("p",_e,o(a.value.total)+"일",1)]),e("div",he,[l[2]||(l[2]=e("p",{class:"text-xs text-gray-500"},"사용한 연차",-1)),e("p",we,o(a.value.used)+"일",1)]),e("div",$e,[l[3]||(l[3]=e("p",{class:"text-xs text-gray-500"},"남은 연차",-1)),e("p",ke,o(Math.max(0,a.value.total-a.value.used))+"일",1)])])):D("",!0),l[5]||(l[5]=e("p",{class:"text-xs text-gray-500 mt-4"},"근로기준법 기준으로 계산된 예상 연차입니다. 실제와 차이가 있을 수 있습니다.",-1))])]))}}),Me={class:"space-y-4"},Se={class:"bg-white rounded-lg border border-gray-200 p-6"},Ce={class:"space-y-3"},Ie={class:"flex items-center justify-between p-4 bg-brand-50 rounded-lg border border-brand-100"},Je={class:"text-xl font-bold text-brand-600"},Fe={class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg"},Le={class:"text-xl font-bold text-gray-600"},Te={class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg"},je={class:"text-xl font-bold text-gray-600"},Ve={class:"bg-white rounded-lg border border-gray-200 p-6"},Ae={class:"flex items-center justify-between mb-4"},qe={class:"text-sm font-semibold text-gray-900"},Be={class:"w-full bg-gray-200 rounded-full h-3 overflow-hidden"},He={class:"mt-4 grid grid-cols-7 gap-2"},Ne={class:"text-xs font-medium text-gray-600 mb-1"},Ee={class:"text-sm font-semibold text-gray-900"},Pe={class:"text-xs text-gray-500"},Ye=J({__name:"WorkSummaryCard",props:{activeJob:{default:null}},setup(w){const u=g("09:00 AM"),s=g("02:30 PM"),d=g("5시간 30분"),t=g(35),a=g([{label:"월",hours:8,percentage:100},{label:"화",hours:8,percentage:100},{label:"수",hours:8,percentage:100},{label:"목",hours:8,percentage:100},{label:"금",hours:3,percentage:37},{label:"토",hours:0,percentage:0},{label:"일",hours:0,percentage:0}]),f=k(()=>t.value/40*100),r=()=>{const x=new Date;String(x.getHours()).padStart(2,"0");const c=String(x.getMinutes()).padStart(2,"0"),_=x.getHours()>=12?"PM":"AM",$=x.getHours()%12||12;s.value=`${String($).padStart(2,"0")}:${c} ${_}`};let l=null;return E(()=>{r(),l=setInterval(r,6e4)}),W(()=>{l&&clearInterval(l)}),(x,c)=>(m(),p("div",Me,[e("div",Se,[c[3]||(c[3]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"오늘 근무현황",-1)),e("div",Ce,[e("div",Ie,[c[0]||(c[0]=e("div",null,[e("p",{class:"text-sm font-medium text-gray-700"},"출근시간"),e("p",{class:"text-xs text-gray-500 mt-1"},"오늘의 시작 시간")],-1)),e("p",Je,o(u.value),1)]),e("div",Fe,[c[1]||(c[1]=e("div",null,[e("p",{class:"text-sm font-medium text-gray-700"},"현재시간"),e("p",{class:"text-xs text-gray-500 mt-1"},"지금 시각")],-1)),e("p",Le,o(s.value),1)]),e("div",Te,[c[2]||(c[2]=e("div",null,[e("p",{class:"text-sm font-medium text-gray-700"},"누적근로시간"),e("p",{class:"text-xs text-gray-500 mt-1"},"오늘 일한 시간")],-1)),e("p",je,o(d.value),1)])])]),e("div",Ve,[e("div",Ae,[c[4]||(c[4]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900"},"이번주 근로시간"),e("p",{class:"text-xs text-gray-500 mt-1"},"월요일 ~ 일요일")],-1)),e("p",qe,o(t.value)+" / 40시간",1)]),e("div",Be,[e("div",{class:"bg-gradient-to-r from-brand-500 to-brand-600 h-3 rounded-full transition-all duration-300",style:z({width:f.value+"%"})},null,4)]),e("div",He,[(m(!0),p(B,null,H(a.value,(_,$)=>(m(),p("div",{key:$,class:"text-center"},[e("p",Ne,o(_.label),1),e("p",Ee,o(_.hours)+"h",1),e("p",Pe,o(_.percentage)+"%",1)]))),128))])]),c[5]||(c[5]=e("div",{class:"bg-gradient-to-r from-brand-600 to-brand-700 rounded-lg p-6 text-white"},[e("h3",{class:"text-lg font-semibold mb-2"},"근무 관련 상담이 필요하신가요?"),e("p",{class:"text-sm text-brand-100 mb-4"},"공인 노무사와 1:1 상담을 통해 근로환경을 진단받으세요."),e("button",{class:"w-full bg-white text-brand-600 py-2 rounded-lg font-semibold hover:bg-brand-50 transition-colors"}," 상담 신청하기 ")],-1))]))}}),Ue={class:"bg-white rounded-lg border border-gray-200 p-6 h-full overflow-auto"},We={class:"max-w-4xl mx-auto"},ze={key:0,class:"mb-6 pb-4 border-b border-gray-200"},Ke={class:"flex items-center justify-between"},Re={class:"text-2xl font-bold text-gray-900"},Qe={class:"text-sm text-gray-600 mt-1"},Ge={class:"text-right"},Xe={class:"text-lg font-bold text-brand-600"},Ze={class:"grid lg:grid-cols-3 gap-6"},Oe={class:"lg:col-span-2"},et={class:"lg:col-span-1"},ot=J({__name:"DashboardContent",setup(w){const{activeJob:u}=P();function s(d){return d.toLocaleString("ko-KR")+"원"}return(d,t)=>(m(),p("div",Ue,[e("div",We,[I(u)?(m(),p("div",ze,[t[1]||(t[1]=e("p",{class:"text-sm text-gray-600 mb-1"},"현재 선택된 알바",-1)),e("div",Ke,[e("div",null,[e("h2",Re,o(I(u).workplace_name),1),e("p",Qe,o(I(u).workplace_address),1)]),e("div",Ge,[t[0]||(t[0]=e("p",{class:"text-sm text-gray-600"},"시급",-1)),e("p",Xe,o(s(I(u).hourly_rate)),1)])])])):D("",!0),e("div",Ze,[e("div",Oe,[q(ce,{activeJob:I(u)},null,8,["activeJob"]),q(De)]),e("div",et,[q(Ye,{activeJob:I(u)},null,8,["activeJob"])])]),t[2]||(t[2]=K('<div class="mt-6"><div class="grid md:grid-cols-2 gap-6"><div class="bg-white rounded-lg border border-gray-200 p-6"><h3 class="text-lg font-semibold text-gray-900 mb-4">편의기능</h3><div class="space-y-3"><button class="w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-brand-50 hover:border-brand-200 border border-gray-200 transition-colors"><p class="text-sm font-semibold text-gray-900">근로계약서 관리</p><p class="text-xs text-gray-500 mt-1">계약서 업로드 및 확인</p></button><button class="w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-brand-50 hover:border-brand-200 border border-gray-200 transition-colors"><p class="text-sm font-semibold text-gray-900">급여 명세서</p><p class="text-xs text-gray-500 mt-1">월별 급여 내역 조회</p></button><button class="w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-brand-50 hover:border-brand-200 border border-gray-200 transition-colors"><p class="text-sm font-semibold text-gray-900">진단 결과</p><p class="text-xs text-gray-500 mt-1">근로환경 진단 결과 보기</p></button></div></div><div class="bg-white rounded-lg border border-gray-200 p-6"><h3 class="text-lg font-semibold text-gray-900 mb-4">고객센터</h3><div class="space-y-3 mb-4"><div class="border-b border-gray-200 pb-3"><p class="text-sm font-medium text-gray-900">근로시간은 어떻게 기록하나요?</p><p class="text-xs text-gray-500 mt-2">매일 출퇴근 시간을 기록하시면 자동으로 계산됩니다.</p></div><div class="border-b border-gray-200 pb-3"><p class="text-sm font-medium text-gray-900">상담 신청은 어떻게 하나요?</p><p class="text-xs text-gray-500 mt-2">상담 신청 페이지에서 원하는 주제를 선택하면 됩니다.</p></div></div><button class="w-full bg-brand-600 text-white py-2 rounded-lg font-medium hover:bg-brand-700 transition-colors text-sm"> 더 많은 FAQ 보기 </button></div></div></div>',1))])]))}});export{ot as default};
